# SPI Slave with Single Port RAM
* SPI is a synchronous serial communication protocol used to transfer data between a master and one or more slave devices. It operates in full-duplex mode, meaning that data can be sent and received simultaneously.
* Single-port RAM, on the other hand, allows only one operation (read or write) at a time, requiring careful management to avoid access conflicts.

* The goal of this project is to design and implement a Serial Peripheral Interface (SPI) slave device that interfaces with a synchronus single-port RAM.

![System](https://github.com/user-attachments/assets/5973d357-61af-4116-8630-62e1616430e1)

## Contents
The project consists of the following components:


*  "RTL" Folder:
	* SPI_Slave.v: Verilog design for the SPI slave block.
  	* RAM.v: Verilog design for the single-port RAM block.
	* SPI_Wrapper.v: Top-level module that instantiates the SPI slave and RAM blocks.

    
* "Testbench" Folder:
	* TB.v: TB.v: Verilog testbench that instantiates both the SPI slave and RAM blocks for verification.
	* mem.dat: Memory initialization data for the testbench.


* "FPGA Flow" Folder
	* Elaborated_Schematic: Schematic of the entire design after elaboration in Vivado.
 	* Synthesized_Schematic_Schematic: Schematic of the entire design after synthesis in Vivado.
  	* Constraints_basys3.xdc: Constraints file for the target FPGA.
  	* Bitstream.bit: Bitstream file generated for FPGA configuration.
	* Netlist.v: Verilog netlist file generated by Vivado.



## SPI Slave Module
The SPI slave module is responsible for receiving data from the master device and interacting with the RAM module. It includes the following ports:

|    Name   | Type | Size | Description |
| :---: | :---: | :---: | :---  |
| clk       |  Input | 1 bit  | Clock signal |
| rst_n     |  Input | 1 bit  | Active low reset signal |
| SS_n      |  Input | 1 bit  | Slave Select signal |
| MOSI      |  Input | 1 bit  | Master-Out-Slave-In data signal |
| tx_data   |  Input | 10 bit | Transfer data output signal; Takes MOSI for 10 clock cycles and stores it in tx_data to send to the RAM |
| tx_valid  |  Input | 1 bit  | Indicates when tx_data is valid |
| MISO      | Output | 1 bit  | Master-In-Slave-Out data signal |
| rx_data   | Output | 10 bit | Received data from the memory |
| rx_valid  | Output | 1 bit  | Indicates when rx_data is valid |

## Single Port Sync RAM Module
The Single Port Sync. RAM module implements a memory block with a single data port.

* Parameters:
  - MEM_DEPTH (default: 256): Depth of the memory.
  - ADDR_SIZE (default: 8): Size of the memory address.

* Ports:
  
|    Name   | Type | Size | Description |
| :---: | :---: | :---: | :---  |
| clk       |  Input   | 1 bit   | Clock signal |
| rst_n     |  Input   | 1 bit   | Active low reset signal |
| din       |  Input   | 10 bit  | Data input |
| rx_valid  |  Input   | 1 bit   | If HIGH, accepts din[7:0] to save the write/read address internally or writes a memory word depending on the most significant 2 bits din[9:8] |
| dout      |  Output  | 8 bit   | Data output |
| tx_valid  |  Output  | 1 bit   | HIGH when the command is a memory read; indicates valid data in dout |

* The MSB two bits of din (din[9:8]) determine the operation to be performed:

|    Port   | din[9:8] | Command | Description |
| :---: | :---: | :---: | :---  |
| din   | 00 | Write | Holds din[7:0] internally as a write address |
| din   | 01 | Write | Writes din[7:0] to the memory with the write address held previously |
| din   | 10 | Read  | Holds din[7:0] internally as a read address |
| din   | 11 | Read  | Reads the memory with the read address held previously. tx_valid should be HIGH, and dout holds the word read from the memory. din[7:0] is ignored |

## Wire connections:
* rx_data in the SPI slave module is connected to the din port in the RAM module.
* rx_valid in the SPI slave module is connected to rx_valid in the RAM module.
* dout in the RAM module is connected to tx_data in the SPI slave module.
* tx_valid in the RAM module is connected to tx_valid in the SPI slave module.

## Finite State Machine (FSM)
![FSM](https://github.com/user-attachments/assets/c5ef4c3a-efd0-4059-9d5f-e03f6df47227)
